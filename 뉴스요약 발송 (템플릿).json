{
  "name": "뉴스요약 발송 (템플릿)",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1296,
        224
      ],
      "id": "e3a93436-d4b2-456e-9c18-25fa6e820b24",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -896,
        224
      ],
      "id": "16526003-b89f-4f16-9ec7-93f4d210d185",
      "name": "키워드 수만큼 반복"
    },
    {
      "parameters": {
        "url": "https://openapi.naver.com/v1/search/news",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "query",
              "value": "={{ $json.keyword }}"
            },
            {
              "name": "display",
              "value": "10"
            },
            {
              "name": "sort",
              "value": "sim"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Naver-Client-Id"
            },
            {
              "name": "X-Naver-Client-Secret"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -608,
        416
      ],
      "id": "16c7ded7-a94d-4f32-8b93-92d83b797e21",
      "name": "네이버 뉴스 검색"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1104,
        224
      ],
      "id": "c501947e-c099-4272-b896-9ae33e917985",
      "name": "키워드 불러오기",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "FW3F1Q973U56OZD7",
          "name": "Google Sheets account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "### 네이버 검색 설정\n1. 검색 건수/필터링 기준: sim/date\n2. API 키 입력 ",
        "height": 288,
        "width": 272
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -688,
        320
      ],
      "typeVersion": 1,
      "id": "a18ffef8-a596-401c-af55-27967a34b582",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "### OpenAI 노드 설정\n1. API 인증키 설정\n2. (선택) System Prompt 변경 ",
        "height": 272,
        "width": 272
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        -256
      ],
      "typeVersion": 1,
      "id": "d705e7fe-5151-4565-a500-6f0d013f71ce",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "### Gmail 설정\n1. 인증키 설정\n2. 받는 사람 설정",
        "height": 272,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1136,
        -256
      ],
      "typeVersion": 1,
      "id": "6bc61d17-3448-44a6-8ca5-573713f255c8",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "fieldToSplitOut": "items",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -624,
        96
      ],
      "id": "decb5e9d-0ebf-4b4b-b338-a4b7441a8405",
      "name": "데이터 쪼개기"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "GPT-4.1"
        },
        "messages": {
          "values": [
            {
              "content": "# AI 뉴스 다이제스트 생성 시스템\n당신은 AI 업계 뉴스를 재미있고 간결하게 요약하는 전문가입니다. 제공받은 모든 뉴스의 헤드라인과 요약본을 종합해서 정확한 출력 형식으로 요약을 제공해주세요.\n\n## 작성 스타일\n- **톤**: 반말, 친근하고 캐주얼한 말투\n- **길이**: 각 뉴스는 1-2문장으로 극도로 간결하게  \n- **분위기**: 유튜브 쇼츠 같은 빠르고 재미있는 느낌\n- **이모지**: 각 섹션마다 적절한 이모지 사용\n- **종합요약은 3줄만**: 종합요약을 3줄로 작성\n- **흥미로운 뉴스 5개**: 흥미로운 뉴스는 5개 선정해서 링크와 제공\n- **구조 템플릿 헤더 준수**: 반드시 헤더 제목을 준수하고, 헤더 하위 내용은 text로 출력하세요.",
              "role": "system"
            },
            {
              "content": "# 출력 형식\n🗞️ 종합요약\n- \n- \n- \n\n🔥 흥미로운 뉴스\n제목1 \n링크1\n\n제목2\n링크2\n\n제목3\n링크3\n\n제목4 \n링크4\n\n제목5 \n링크5",
              "role": "system"
            },
            {
              "content": "=# 분석 대상\n{{ JSON.stringify($json.data) }}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        32,
        -144
      ],
      "id": "540f394f-0c50-487d-9f7b-27a10126e805",
      "name": "GPT 뉴스 요약 요청"
    },
    {
      "parameters": {
        "jsCode": "// 이전 노드의 첫 번째 아이템에서 content를 직접 가져옵니다.\nconst content = $input.first().json.message.content;\n\n// 1. 특정 제목들을 <h3> 태그로 감싸서 크고 굵게 만듭니다.\nlet styledContent = content.replace('🗞️ 종합요약', '<h3>🗞️ 종합요약</h3>');\nstyledContent = styledContent.replace('🔥 흥미로운 뉴스', '<h3>🔥 흥미로운 뉴스</h3>');\n\n// 2. 전체 텍스트의 줄바꿈(\\n)을 HTML 태그(<br>)로 변경합니다.\nconst htmlContent = styledContent.replace(/\\n/g, '<br>');\n\n// 다음 노드로 전달할 데이터를 구성합니다.\nreturn {\n  json: {\n    ...$input.first().json,\n    htmlContent: htmlContent\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        368,
        -336
      ],
      "id": "9d876d66-8e6f-4eb6-b655-b24321bb4611",
      "name": "요약 결과 HTML 서식"
    },
    {
      "parameters": {
        "resource": "image",
        "prompt": "=다음 내용 중에 종합요약에 해당하는 부분에 알맞는 일러스트를 그려줘.\n{{ $json.message.content }}",
        "options": {
          "style": "natural"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        384,
        64
      ],
      "id": "ee680f5f-0080-434a-9ada-352d17f7e51b",
      "name": "썸네일 이미지 제작",
      "credentials": {
        "openAiApi": {
          "id": "wcyWsC4QEwsw8pEf",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.imgbb.com/1/upload?key=9bfc3355a506399626ee74e1fba19c11",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "image",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        608,
        64
      ],
      "id": "712cba5c-7c48-4205-aa8c-d59452b498a9",
      "name": "이미지 업로드-주소받기"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        832,
        -144
      ],
      "id": "d5998e49-8d1d-499a-a2d0-5e179cd08176",
      "name": "노드 결과 통합"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        992,
        -144
      ],
      "id": "1e5e52cb-74ce-4db4-b754-8709d76eea1e",
      "name": "노드 데이터 통합"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -192,
        -144
      ],
      "id": "316023f7-b51f-4f7e-bdb6-f5ef739dac30",
      "name": "뉴스 데이터 통합"
    },
    {
      "parameters": {
        "subject": "=🗞️ 오늘의 뉴스요약 ({{ $now.format('yyyy-LL-dd') }})",
        "message": "=<div>\n  <img src=\"{{ $json.data[1].data.medium.url }}\" alt=\"data\" border=\"0\" style=\"max-width: 100%; height: auto;\" />\n</div>\n<div>\n  {{ $json.data[0].htmlContent }}\n</div>",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1184,
        -144
      ],
      "id": "e4a10d0e-4b7c-4c15-8103-ca384f1a4b2b",
      "name": "메일 발송",
      "webhookId": "8fa2280a-971b-4d28-b655-56344b1b2b87"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": ""
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": ""
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -176,
        304
      ],
      "id": "7cd84878-71e9-4e90-b4e8-8afa5f914851",
      "name": "Append row in sheet"
    },
    {
      "parameters": {
        "content": "### 구글 시트 설정\n1. 인증 설정\n2. 저장 파일/시트/컬럼 설정",
        "height": 288,
        "width": 272
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -256,
        192
      ],
      "typeVersion": 1,
      "id": "940a4cb4-2e57-458d-a37d-f72b3bf4042f",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "### 구글 시트 설정\n1. 인증 설정\n2. 불러올 파일/시트 설정",
        "height": 288,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1152,
        112
      ],
      "typeVersion": 1,
      "id": "c203d2f4-e1a3-4503-8db6-b02ac07e1e3c",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "content": "### OpenAI 노드 설정\n1. API 인증키 설정\n2. (선택) System Prompt 변경 ",
        "height": 272,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        336,
        -48
      ],
      "typeVersion": 1,
      "id": "fc71cde5-1cf7-4944-80e4-7ad943c97e18",
      "name": "Sticky Note1"
    }
  ],
  "pinData": {},
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "키워드 불러오기",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "키워드 수만큼 반복": {
      "main": [
        [
          {
            "node": "데이터 쪼개기",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "네이버 뉴스 검색",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "네이버 뉴스 검색": {
      "main": [
        [
          {
            "node": "키워드 수만큼 반복",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "키워드 불러오기": {
      "main": [
        [
          {
            "node": "키워드 수만큼 반복",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "데이터 쪼개기": {
      "main": [
        [
          {
            "node": "뉴스 데이터 통합",
            "type": "main",
            "index": 0
          },
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GPT 뉴스 요약 요청": {
      "main": [
        [
          {
            "node": "썸네일 이미지 제작",
            "type": "main",
            "index": 0
          },
          {
            "node": "요약 결과 HTML 서식",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "요약 결과 HTML 서식": {
      "main": [
        [
          {
            "node": "노드 결과 통합",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "썸네일 이미지 제작": {
      "main": [
        [
          {
            "node": "이미지 업로드-주소받기",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "이미지 업로드-주소받기": {
      "main": [
        [
          {
            "node": "노드 결과 통합",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "노드 결과 통합": {
      "main": [
        [
          {
            "node": "노드 데이터 통합",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "노드 데이터 통합": {
      "main": [
        [
          {
            "node": "메일 발송",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "뉴스 데이터 통합": {
      "main": [
        [
          {
            "node": "GPT 뉴스 요약 요청",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c96801b9-f450-4b5e-b5d5-6a29e9414f3d",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "6a9739e3f09ef3db6c5a0d4227f41ec01aa52b7bbab4b528e77147e555f60ecc"
  },
  "id": "VGOv1oAfWBLLq5zL",
  "tags": []
}